#!/bin/bash
set -e

if [ -n "${DOTNET_INFO}" ]; then
  /usr/libexec/s2i/container-tool info
fi

if [ "$DEV_MODE" == true ]; then
    # Monitor changes.
    while true; do
      pyinotify -r -a -e IN_CREATE,IN_DELETE,IN_MODIFY,IN_MOVED_TO -c "flock -n /tmp/devmode_lock /usr/libexec/s2i/_devmode_run" .
    done
else
    cd $DOTNET_APP_PATH

    echo "---> Running application ..."
    exec "./$DOTNET_DEFAULT_CMD"
fi
